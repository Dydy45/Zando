<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire de produit</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/style.css">
    <link rel="stylesheet" href="styles/theme.css">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Style général */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 0;
            color: #333;
            padding-top: 130px;
        }
        
        /* Barre de recherche et Icônes */
        .search-bar {
            display: flex;
            position :relative;
            right:5px;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 5px 10px;
            background-color: #f9f9f9;
          }
          .search-bar input {
            border: none;
            outline: none;
            font-size: 14px;
            width: 180px;
            padding: 5px;
          }
          /* Bouton de la barre de recherche */
          .search-bar button {
            background: none;
            border: none;
            cursor: pointer;
          }
          .search-bar img {
            width: 16px;
            height: 16px;
          }
          .icons {
            display: flex;
            align-items: center;
            gap: 15px;
            padding-right: 15px;
          }
        
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-top: 20px;
        }

        /* Formulaire */
        form {
            max-width: 600px;
            margin: 30px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        input, textarea, select, button {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 16px;
        }
          
        input[type="number"] {
            -moz-appearance: textfield;
        }

        textarea {
            resize: vertical;
            min-height: 150px;
        }

        button {
            background-color: #3498db;
            color: #fff;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #2980b9;
        }

        input[type="file"] {
            border: none;
            padding: 10px 0;
        }

        /* Informations en FC */
        #price-in-fc, #shipping-in-fc {
            font-size: 16px;
            font-weight: bold;
            color: #2c3e50;
            text-align: center;
        }

        /* Liste des produits récents */
        #recent-products {
            margin: 30px auto;
            max-width: 800px;
        }

        .product-card {
            display: flex;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .product-card img {
            max-width: 150px;
            margin-right: 20px;
            border-radius: 5px;
        }

        .product-card .details {
            flex: 1;
        }

        .product-card .details h3 {
            font-size: 18px;
            margin: 0;
            color: #2c3e50;
        }

        .product-card .details .price {
            font-size: 16px;
            font-weight: bold;
            color: #e74c3c;
        }

        .product-card button {
            background-color: #27ae60;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }

        .product-card button:hover {
            background-color: #2ecc71;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .product-card {
                flex-direction: column;
                align-items: center;
            }

            .product-card img {
                margin-bottom: 15px;
            }

            form {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
  <header>
    <div class="logo">
      <img src="logo/zando-logo.png" alt="Zando" class="site-logo">
    </div>
    <nav class="navigation">
      <a href="index.html">Accueil</a>
      <a href="contact.html">Contact</a>
      <a href="a-propos.html">À propos</a>
      <a href="connexion.html">Se connecter</a>
    </nav>
    <div class="header-actions">
      <div class="search-bar">
        <input type="text" placeholder="Que cherchez-vous ?">
        <button>
          <a href="recherche.html"><span class="material-icons">search</span></a>
        </button>
      </div>
      <div class="icons">
        <a href="favoris.html">
          <span class="material-icons">favorite</span>
        </a>
        <a href="panier.html" class="cart">
          <span class="material-icons">shopping_cart</span>
          <span class="cart-badge" id="cart-badge">0</span>
        </a>
        <div class="user-menu">
          <span class="material-icons user-icon">account_circle</span>
          <div class="dropdown-menu">
            <a href="compte.html">Gérer mon compte</a>
            <a href="commandes.html">Mes commandes</a>
            <a href="annulations.html">Mes annulations</a>
            <a href="avis.html">Mes avis</a>
            <a href="connexion.html" id="logout-link">Déconnexion</a>
          </div>
        </div>
      </div>
    </div>
  </header>
  <main>
    <h1>Publier un nouveau produit</h1>

    <form id="publish-product-form">
        <label for="product-name">Nom du produit</label>
        <input id="product-name" type="text" placeholder="Nom du produit" required>
        
        <label for="product-description">Description</label>
        <textarea id="product-description" placeholder="Description du produit" required></textarea>
        
        <label for="product-price">Prix (USD)</label>
        <input id="product-price" type="number" placeholder="Prix (USD)" required>
        
        <label for="product-category">Catégorie</label>
        <select id="product-category">
            <option value="">Sélectionner une catégorie</option>
            <option value="electronics">Électronique</option>
            <option value="mode-homme">Mode Homme</option>
            <option value="mode-femme">Mode Femme</option>
            <option value="maison">Maison & Style de Vie</option>
            <option value="sport">Sport & Extérieur</option>
            <option value="bebe">Bébé et Jouets</option>
            <option value="alimentation">Alimentation et Animaux</option>
            <option value="sante">Santé et Beauté</option>
        </select>
        
        <label for="shipping-cost">Coût d'expédition (USD)</label>
        <input id="shipping-cost" type="number" placeholder="Coût d'expédition (USD)" required>
        
        <label for="product-image">Image du produit</label>
        <input id="product-image" type="file" accept="image/*" required>
        
        <button type="submit">Publier</button>
    </form>

    <p id="price-in-fc">En Francs Congolais : 0 FC</p>
    <p id="shipping-in-fc">En Francs Congolais : 0 FC</p>
    <div id="recent-products"></div>
  </main>
  <script>
      // Fonction pour convertir un fichier en Base64
    function convertFileToBase64(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.onerror = (error) => reject(error);
            reader.readAsDataURL(file);
        });
    }
    
    document.getElementById("publish-product-form").addEventListener("submit", async (event) => {
        event.preventDefault();
    
        const productName = document.getElementById("product-name").value.trim();
        const productDescription = document.getElementById("product-description").value.trim();
        const productPrice = parseFloat(document.getElementById("product-price").value);
        const productCategory = document.getElementById("product-category").value;
        const productImage = document.getElementById("product-image").files[0];
        const shippingCost = parseFloat(document.getElementById("shipping-cost").value);
    
        if (!productName || !productDescription || isNaN(productPrice) || !productCategory || !productImage || isNaN(shippingCost)) {
            alert("Veuillez remplir tous les champs correctement.");
            return;
        }
    
        // Convertir l'image en Base64
        const productImageBase64 = await convertFileToBase64(productImage);
    
        const product = {
            id: Date.now(),
            name: productName,
            description: productDescription,
            price: productPrice,
            category: productCategory,
            shipping: shippingCost,
            image: productImageBase64, // Sauvegarde en Base64
            timestamp: new Date().toISOString(),
        };
    
        const products = JSON.parse(localStorage.getItem("products")) || [];
        products.push(product);
        localStorage.setItem("products", JSON.stringify(products));
    
        alert("Produit publié avec succès !");
        document.getElementById("publish-product-form").reset();
        document.getElementById("price-in-fc").textContent = "En Francs Congolais : 0 FC";
        document.getElementById("shipping-in-fc").textContent = "En Francs Congolais : 0 FC";
    });
  
  // Mise à jour automatique des conversions en Francs Congolais
  const tauxConversion = 2850;
  
  function updateConversion(inputId, outputId) {
      const inputValue = parseFloat(document.getElementById(inputId).value);
      const outputElement = document.getElementById(outputId);
      if (!isNaN(inputValue)) {
          outputElement.textContent = `En Francs Congolais : ${(inputValue * tauxConversion).toLocaleString()} FC`;
      } else {
          outputElement.textContent = "En Francs Congolais : 0 FC";
      }
  }
  
  document.getElementById("product-price").addEventListener("input", () => {
      updateConversion("product-price", "price-in-fc");
  });
  
  document.getElementById("shipping-cost").addEventListener("input", () => {
      updateConversion("shipping-cost", "shipping-in-fc");
  });
  
  // Aperçu d'image
  document.getElementById("product-image").addEventListener("change", (event) => {
      const file = event.target.files[0];
      if (file) {
          const preview = document.createElement("img");
          preview.src = URL.createObjectURL(file);
          preview.style.maxWidth = "100px";
          preview.style.marginTop = "15px";
          document.getElementById("publish-product-form").appendChild(preview);
      }
  });
    </script>
    <script type="module" src="supabaseClient.js"></script>
    <script type="module" src="scripts/deconnexion.js"></script>
         <!-- removed testFirebase.js for production -->
</body>
</html>